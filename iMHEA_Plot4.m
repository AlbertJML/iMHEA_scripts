%iMHEA_Plot4 is a script to plot FDC, IDC, and monthly data of catchments.
%
% Boris Ochoa Tocachi
% Imperial College London
% Created in June, 2014
% Last edited in November, 2017

%% PROCESS

%% Obtain Monthly P and IDC
iMHEA_MonthlyP = zeros(12,28);
[~,iMHEA_MonthlyP(:,1),iMHEA_LLO_01_IDC] = iMHEA_ProcessP(iMHEA_LLO_01_DataHRes(:,1),iMHEA_LLO_01_DataHRes(:,2));
[~,iMHEA_MonthlyP(:,2),iMHEA_LLO_02_IDC] = iMHEA_ProcessP(iMHEA_LLO_02_DataHRes(:,1),iMHEA_LLO_02_DataHRes(:,2));
[~,iMHEA_MonthlyP(:,3),iMHEA_JTU_01_IDC] = iMHEA_ProcessP(iMHEA_JTU_01_DataHRes(:,1),iMHEA_JTU_01_DataHRes(:,2));
[~,iMHEA_MonthlyP(:,4),iMHEA_JTU_02_IDC] = iMHEA_ProcessP(iMHEA_JTU_02_DataHRes(:,1),iMHEA_JTU_02_DataHRes(:,2));
[~,iMHEA_MonthlyP(:,5),iMHEA_JTU_03_IDC] = iMHEA_ProcessP(iMHEA_JTU_03_DataHRes(:,1),iMHEA_JTU_03_DataHRes(:,2));
[~,iMHEA_MonthlyP(:,6),iMHEA_JTU_04_IDC] = iMHEA_ProcessP(iMHEA_JTU_04_DataHRes(:,1),iMHEA_JTU_04_DataHRes(:,2));
[~,iMHEA_MonthlyP(:,7),iMHEA_PAU_01_IDC] = iMHEA_ProcessP(iMHEA_PAU_01_DataHRes(:,1),iMHEA_PAU_01_DataHRes(:,2));
[~,iMHEA_MonthlyP(:,8),iMHEA_PAU_02_IDC] = iMHEA_ProcessP(iMHEA_PAU_02_DataHRes(:,1),iMHEA_PAU_02_DataHRes(:,2));
[~,iMHEA_MonthlyP(:,9),iMHEA_PAU_03_IDC] = iMHEA_ProcessP(iMHEA_PAU_03_DataHRes(:,1),iMHEA_PAU_03_DataHRes(:,2));
[~,iMHEA_MonthlyP(:,10),iMHEA_PAU_04_IDC] = iMHEA_ProcessP(iMHEA_PAU_04_DataHRes(:,1),iMHEA_PAU_04_DataHRes(:,2));
[~,iMHEA_MonthlyP(:,11),iMHEA_PAU_05_IDC] = iMHEA_ProcessP(iMHEA_PAU_05_DataHRes(:,1),iMHEA_PAU_05_DataHRes(:,2));
[~,iMHEA_MonthlyP(:,12),iMHEA_PIU_01_IDC] = iMHEA_ProcessP(iMHEA_PIU_01_DataHRes(:,1),iMHEA_PIU_01_DataHRes(:,2));
[~,iMHEA_MonthlyP(:,13),iMHEA_PIU_02_IDC] = iMHEA_ProcessP(iMHEA_PIU_02_DataHRes(:,1),iMHEA_PIU_02_DataHRes(:,2));
[~,iMHEA_MonthlyP(:,14),iMHEA_PIU_03_IDC] = iMHEA_ProcessP(iMHEA_PIU_03_DataHRes(:,1),iMHEA_PIU_03_DataHRes(:,2));
[~,iMHEA_MonthlyP(:,15),iMHEA_PIU_04_IDC] = iMHEA_ProcessP(iMHEA_PIU_04_DataHRes(:,1),iMHEA_PIU_04_DataHRes(:,2));
[~,iMHEA_MonthlyP(:,16),iMHEA_PIU_05_IDC] = iMHEA_ProcessP(iMHEA_PIU_05_DataHRes(:,1),iMHEA_PIU_05_DataHRes(:,2));
[~,iMHEA_MonthlyP(:,17),iMHEA_PIU_06_IDC] = iMHEA_ProcessP(iMHEA_PIU_06_DataHRes(:,1),iMHEA_PIU_06_DataHRes(:,2));
[~,iMHEA_MonthlyP(:,18),iMHEA_PIU_07_IDC] = iMHEA_ProcessP(iMHEA_PIU_07_DataHRes(:,1),iMHEA_PIU_07_DataHRes(:,2));
[~,iMHEA_MonthlyP(:,19),iMHEA_CHA_01_IDC] = iMHEA_ProcessP(iMHEA_CHA_01_DataHRes(:,1),iMHEA_CHA_01_DataHRes(:,2));
[~,iMHEA_MonthlyP(:,20),iMHEA_CHA_02_IDC] = iMHEA_ProcessP(iMHEA_CHA_02_DataHRes(:,1),iMHEA_CHA_02_DataHRes(:,2));
[~,iMHEA_MonthlyP(:,21),iMHEA_HUA_01_IDC] = iMHEA_ProcessP(iMHEA_HUA_01_DataHRes(:,1),iMHEA_HUA_01_DataHRes(:,2));
[~,iMHEA_MonthlyP(:,22),iMHEA_HUA_02_IDC] = iMHEA_ProcessP(iMHEA_HUA_02_DataHRes(:,1),iMHEA_HUA_02_DataHRes(:,2));
[~,iMHEA_MonthlyP(:,23),iMHEA_HMT_01_IDC] = iMHEA_ProcessP(iMHEA_HMT_01_DataHRes(:,1),iMHEA_HMT_01_DataHRes(:,2));
[~,iMHEA_MonthlyP(:,24),iMHEA_HMT_02_IDC] = iMHEA_ProcessP(iMHEA_HMT_02_DataHRes(:,1),iMHEA_HMT_02_DataHRes(:,2));
[~,iMHEA_MonthlyP(:,25),iMHEA_TAM_01_IDC] = iMHEA_ProcessP(iMHEA_TAM_01_DataHRes(:,1),iMHEA_TAM_01_DataHRes(:,2));
[~,iMHEA_MonthlyP(:,26),iMHEA_TAM_02_IDC] = iMHEA_ProcessP(iMHEA_TAM_02_DataHRes(:,1),iMHEA_TAM_02_DataHRes(:,2));
[~,iMHEA_MonthlyP(:,27),iMHEA_TIQ_01_IDC] = iMHEA_ProcessP(iMHEA_TIQ_01_DataHRes(:,1),iMHEA_TIQ_01_DataHRes(:,2));
[~,iMHEA_MonthlyP(:,28),iMHEA_TIQ_02_IDC] = iMHEA_ProcessP(iMHEA_TIQ_02_DataHRes(:,1),iMHEA_TIQ_02_DataHRes(:,2));

%% Obtain Monthly Q and FDC
iMHEA_MonthlyQ = zeros(12,25);
[~,iMHEA_MonthlyQ(:,1),iMHEA_LLO_01_FDC] = iMHEA_ProcessQ(iMHEA_LLO_01_DataHRes(:,1),iMHEA_LLO_01_DataHRes(:,3));
[~,iMHEA_MonthlyQ(:,2),iMHEA_LLO_02_FDC] = iMHEA_ProcessQ(iMHEA_LLO_02_DataHRes(:,1),iMHEA_LLO_02_DataHRes(:,3));
[~,iMHEA_MonthlyQ(:,3),iMHEA_JTU_01_FDC] = iMHEA_ProcessQ(iMHEA_JTU_01_DataHRes(:,1),iMHEA_JTU_01_DataHRes(:,3));
[~,iMHEA_MonthlyQ(:,4),iMHEA_JTU_02_FDC] = iMHEA_ProcessQ(iMHEA_JTU_02_DataHRes(:,1),iMHEA_JTU_02_DataHRes(:,3));
[~,iMHEA_MonthlyQ(:,5),iMHEA_JTU_03_FDC] = iMHEA_ProcessQ(iMHEA_JTU_03_DataHRes(:,1),iMHEA_JTU_03_DataHRes(:,3));
[~,iMHEA_MonthlyQ(:,6),iMHEA_JTU_04_FDC] = iMHEA_ProcessQ(iMHEA_JTU_04_DataHRes(:,1),iMHEA_JTU_04_DataHRes(:,3));
[~,iMHEA_MonthlyQ(:,7),iMHEA_PAU_01_FDC] = iMHEA_ProcessQ(iMHEA_PAU_01_DataHRes(:,1),iMHEA_PAU_01_DataHRes(:,3));
[~,iMHEA_MonthlyQ(:,8),iMHEA_PAU_02_FDC] = iMHEA_ProcessQ(iMHEA_PAU_02_DataHRes(:,1),iMHEA_PAU_02_DataHRes(:,3));
[~,iMHEA_MonthlyQ(:,9),iMHEA_PAU_03_FDC] = iMHEA_ProcessQ(iMHEA_PAU_03_DataHRes(:,1),iMHEA_PAU_03_DataHRes(:,3));
[~,iMHEA_MonthlyQ(:,10),iMHEA_PAU_04_FDC] = iMHEA_ProcessQ(iMHEA_PAU_04_DataHRes(:,1),iMHEA_PAU_04_DataHRes(:,3));
[~,iMHEA_MonthlyQ(:,11),iMHEA_PIU_01_FDC] = iMHEA_ProcessQ(iMHEA_PIU_01_DataHRes(:,1),iMHEA_PIU_01_DataHRes(:,3));
[~,iMHEA_MonthlyQ(:,12),iMHEA_PIU_02_FDC] = iMHEA_ProcessQ(iMHEA_PIU_02_DataHRes(:,1),iMHEA_PIU_02_DataHRes(:,3));
[~,iMHEA_MonthlyQ(:,13),iMHEA_PIU_03_FDC] = iMHEA_ProcessQ(iMHEA_PIU_03_DataHRes(:,1),iMHEA_PIU_03_DataHRes(:,3));
[~,iMHEA_MonthlyQ(:,14),iMHEA_PIU_04_FDC] = iMHEA_ProcessQ(iMHEA_PIU_04_DataHRes(:,1),iMHEA_PIU_04_DataHRes(:,3));
[~,iMHEA_MonthlyQ(:,15),iMHEA_PIU_07_FDC] = iMHEA_ProcessQ(iMHEA_PIU_07_DataHRes(:,1),iMHEA_PIU_07_DataHRes(:,3));
[~,iMHEA_MonthlyQ(:,16),iMHEA_CHA_01_FDC] = iMHEA_ProcessQ(iMHEA_CHA_01_DataHRes(:,1),iMHEA_CHA_01_DataHRes(:,3));
[~,iMHEA_MonthlyQ(:,17),iMHEA_CHA_02_FDC] = iMHEA_ProcessQ(iMHEA_CHA_02_DataHRes(:,1),iMHEA_CHA_02_DataHRes(:,3));
[~,iMHEA_MonthlyQ(:,18),iMHEA_HUA_01_FDC] = iMHEA_ProcessQ(iMHEA_HUA_01_DataHRes(:,1),iMHEA_HUA_01_DataHRes(:,3));
[~,iMHEA_MonthlyQ(:,19),iMHEA_HUA_02_FDC] = iMHEA_ProcessQ(iMHEA_HUA_02_DataHRes(:,1),iMHEA_HUA_02_DataHRes(:,3));
[~,iMHEA_MonthlyQ(:,20),iMHEA_HMT_01_FDC] = iMHEA_ProcessQ(iMHEA_HMT_01_DataHRes(:,1),iMHEA_HMT_01_DataHRes(:,3));
[~,iMHEA_MonthlyQ(:,21),iMHEA_HMT_02_FDC] = iMHEA_ProcessQ(iMHEA_HMT_02_DataHRes(:,1),iMHEA_HMT_02_DataHRes(:,3));
[~,iMHEA_MonthlyQ(:,22),iMHEA_TAM_01_FDC] = iMHEA_ProcessQ(iMHEA_TAM_01_DataHRes(:,1),iMHEA_TAM_01_DataHRes(:,3));
[~,iMHEA_MonthlyQ(:,23),iMHEA_TAM_02_FDC] = iMHEA_ProcessQ(iMHEA_TAM_02_DataHRes(:,1),iMHEA_TAM_02_DataHRes(:,3));
[~,iMHEA_MonthlyQ(:,24),iMHEA_TIQ_01_FDC] = iMHEA_ProcessQ(iMHEA_TIQ_01_DataHRes(:,1),iMHEA_TIQ_01_DataHRes(:,3));
[~,iMHEA_MonthlyQ(:,25),iMHEA_TIQ_02_FDC] = iMHEA_ProcessQ(iMHEA_TIQ_02_DataHRes(:,1),iMHEA_TIQ_02_DataHRes(:,3));

% Monthly discharge in mm.
MDays = [31 28 31 30 31 30 31 31 30 31 30 31]';
iMHEA_MonthlyQ = iMHEA_MonthlyQ.*MDays/1000000*86400;

%% PLOT RESULTS
figure

%% FDC
subplot(2,2,4)
semilogy(iMHEA_LLO_01_FDC(:,1),iMHEA_LLO_01_FDC(:,2)/1000000*86400,...
    iMHEA_LLO_02_FDC(:,1),iMHEA_LLO_02_FDC(:,2)/1000000*86400,...
    iMHEA_JTU_01_FDC(:,1),iMHEA_JTU_01_FDC(:,2)/1000000*86400,...
    iMHEA_JTU_02_FDC(:,1),iMHEA_JTU_02_FDC(:,2)/1000000*86400,...
    iMHEA_JTU_03_FDC(:,1),iMHEA_JTU_03_FDC(:,2)/1000000*86400,...
    iMHEA_JTU_04_FDC(:,1),iMHEA_JTU_04_FDC(:,2)/1000000*86400,...
    iMHEA_PAU_01_FDC(:,1),iMHEA_PAU_01_FDC(:,2)/1000000*86400,...
    iMHEA_PAU_02_FDC(:,1),iMHEA_PAU_02_FDC(:,2)/1000000*86400,...
    iMHEA_PAU_03_FDC(:,1),iMHEA_PAU_03_FDC(:,2)/1000000*86400,...
    iMHEA_PAU_04_FDC(:,1),iMHEA_PAU_04_FDC(:,2)/1000000*86400,...
    iMHEA_PIU_01_FDC(:,1),iMHEA_PIU_01_FDC(:,2)/1000000*86400,...
    iMHEA_PIU_02_FDC(:,1),iMHEA_PIU_02_FDC(:,2)/1000000*86400,...
    iMHEA_PIU_03_FDC(:,1),iMHEA_PIU_03_FDC(:,2)/1000000*86400,...
    iMHEA_PIU_04_FDC(:,1),iMHEA_PIU_04_FDC(:,2)/1000000*86400,...
    iMHEA_PIU_07_FDC(:,1),iMHEA_PIU_07_FDC(:,2)/1000000*86400,...
    iMHEA_CHA_01_FDC(:,1),iMHEA_CHA_01_FDC(:,2)/1000000*86400,...
    iMHEA_CHA_02_FDC(:,1),iMHEA_CHA_02_FDC(:,2)/1000000*86400,...
    iMHEA_HUA_01_FDC(:,1),iMHEA_HUA_01_FDC(:,2)/1000000*86400,...
    iMHEA_HUA_02_FDC(:,1),iMHEA_HUA_02_FDC(:,2)/1000000*86400,...
    iMHEA_HMT_01_FDC(:,1),iMHEA_HMT_01_FDC(:,2)/1000000*86400,...
    iMHEA_HMT_02_FDC(:,1),iMHEA_HMT_02_FDC(:,2)/1000000*86400,...
    iMHEA_TAM_01_FDC(:,1),iMHEA_TAM_01_FDC(:,2)/1000000*86400,...
    iMHEA_TAM_02_FDC(:,1),iMHEA_TAM_02_FDC(:,2)/1000000*86400,...
    iMHEA_TIQ_01_FDC(:,1),iMHEA_TIQ_01_FDC(:,2)/1000000*86400,...
    iMHEA_TIQ_02_FDC(:,1),iMHEA_TIQ_02_FDC(:,2)/1000000*86400)
set(gca,'XLim',[-5 105],'YLim',[0.0001 1000])
ylabel('Daily flow [mm day^{-1}]')
% legend(iMHEA_SiteName,'Location','NorthEast')
set(gca,'XLim',[-5 105],'YLim',[0.0001 100])
title('Flow Duration Curves')
xlabel('Exceedance probability')
grid on; box on;
legend('boxoff')

%% IDC

subplot(2,2,3)
semilogx(iMHEA_LLO_01_IDC(:,1),iMHEA_LLO_01_IDC(:,2),...
    iMHEA_LLO_02_IDC(:,1),iMHEA_LLO_02_IDC(:,2),...
    iMHEA_JTU_01_IDC(:,1),iMHEA_JTU_01_IDC(:,2),...
    iMHEA_JTU_02_IDC(:,1),iMHEA_JTU_02_IDC(:,2),...
    iMHEA_JTU_03_IDC(:,1),iMHEA_JTU_03_IDC(:,2),...
    iMHEA_JTU_04_IDC(:,1),iMHEA_JTU_04_IDC(:,2),...
    iMHEA_PAU_01_IDC(:,1),iMHEA_PAU_01_IDC(:,2),...
    iMHEA_PAU_02_IDC(:,1),iMHEA_PAU_02_IDC(:,2),...
    iMHEA_PAU_03_IDC(:,1),iMHEA_PAU_03_IDC(:,2),...
    iMHEA_PAU_04_IDC(:,1),iMHEA_PAU_04_IDC(:,2),...
    iMHEA_PAU_05_IDC(:,1),iMHEA_PAU_05_IDC(:,2),...
    iMHEA_PIU_01_IDC(:,1),iMHEA_PIU_01_IDC(:,2),...
    iMHEA_PIU_02_IDC(:,1),iMHEA_PIU_02_IDC(:,2),...
    iMHEA_PIU_03_IDC(:,1),iMHEA_PIU_03_IDC(:,2),...
    iMHEA_PIU_04_IDC(:,1),iMHEA_PIU_04_IDC(:,2),...
    iMHEA_PIU_05_IDC(:,1),iMHEA_PIU_05_IDC(:,2),...
    iMHEA_PIU_06_IDC(:,1),iMHEA_PIU_06_IDC(:,2),...
    iMHEA_PIU_07_IDC(:,1),iMHEA_PIU_07_IDC(:,2),...
    iMHEA_CHA_01_IDC(:,1),iMHEA_CHA_01_IDC(:,2),...
    iMHEA_CHA_02_IDC(:,1),iMHEA_CHA_02_IDC(:,2),...
    iMHEA_HUA_01_IDC(:,1),iMHEA_HUA_01_IDC(:,2),...
    iMHEA_HUA_02_IDC(:,1),iMHEA_HUA_02_IDC(:,2),...
    iMHEA_HMT_01_IDC(:,1),iMHEA_HMT_01_IDC(:,2),...
    iMHEA_HMT_02_IDC(:,1),iMHEA_HMT_02_IDC(:,2),...
    iMHEA_TAM_01_IDC(:,1),iMHEA_TAM_01_IDC(:,2),...
    iMHEA_TAM_02_IDC(:,1),iMHEA_TAM_02_IDC(:,2),...
    iMHEA_TIQ_01_IDC(:,1),iMHEA_TIQ_01_IDC(:,2),...
    iMHEA_TIQ_02_IDC(:,1),iMHEA_TIQ_02_IDC(:,2))
set(gca,'Xlim',[5 2880],...
    'XTick',iMHEA_LLO_01_IDC(:,1),'XTickLabel',num2str(iMHEA_LLO_01_IDC(:,1)))
title('Maximum Intensity-Duration Curves')
xlabel('Duration')
ylabel('Rainfall intensity [mm h^{-1}]')
grid on; box on;
% legend('boxoff')

%% MONTHLY DATA
MonthName = {'J','F','M','A','M','J','J','A','S','O','N','D'};
subplot(2,2,1)
parallelcoords(iMHEA_MonthlyP','group',iMHEA_Names_Text{:,4},'Labels',MonthName);
title('Average monthly precipitation')
ylabel('[mm month^{-1}]')
grid on; box on;
set(gca,'Xlim',[1 12])
legend('boxoff')

subplot(2,2,2)
parallelcoords(iMHEA_MonthlyQ','group',iMHEA_Names_Text{1:25,2},'Labels',MonthName);
title('Average monthly discharge')
ylabel('[mm month^{-1}]')
grid on; box on;
set(gca,'Xlim',[1 12])
legend('boxoff')